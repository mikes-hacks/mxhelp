# First
nmap -p- --min-rate=1000 -T4 192.168.200.5 -v --open -Pn | tee nmap-ports
grep ^[0-9] ./nmap-ports
ports=\$(grep ^[0-9] ./nmap-ports | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
sudo nmap -sV -sC -O -v -p $ports 192.168.200.5 -Pn -v -oG nmap-fulltcp
grep ^[0-9] ./nmap-fulltcp

# Consider UDP
sudo nmap --top-ports 20 -sU -sV -sC -v 192.168.200.5 -oG nmap-udp20
sudo nmap -sUV -T4 -F -v --version-intensity 0 192.168.200.5 -oG nmap-udpfast
sudo nmap -p0-65535 -Pn â€“sU -v 192.168.200.5 -oG nmap-udpall

# Consider nmapAutomator
sudo nmapAutomator.sh -H 192.168.200.5 -t Script | tee nmap-script
sudo nmapAutomator.sh -H 192.168.200.5 -t Vulns | tee nmap-vulns
sudo nmapAutomator.sh -H 192.168.200.5 -t Recon | tee nmap-recon

# Vulns
nmap -Pn -v --script vuln 192.168.1.105  ..vul/cve detection, No Pings 
nmap --script safe -v -p 445 192.168.200.5

# Scripts
locate -r '\.nse$' | xargs grep categories | grep 'default\|version\|safe' | grep smb
ls -l /usr/share/nmap/scripts/nfs* 

# Services
nmap -p 443 -v --script ssl-heartbleed 192.168.200.5
nmap -p 3306 -v --script mysql-brute -T5 -nv 192.168.200.5
nmap -p 21 -v --script ftp-brute 192.168.200.5 
nmap -p 21 -v --script ftp-* 192.168.200.5 
nmap -sU -p 69 -v --script tftp-enum.nse 192.168.200.5 
nmap -sU -p 69 -v --script tftp-enum.nse --script-args tftp-enum.filelist=windowsloot.txt 192.168.200.5
nmap -pT:25 -v --script smtp-commands.nse 192.168.200.5 
nmap -p 80 -nv --script=http-vuln-cve2010-2861 192.168.200.5  #coldfusion 
nmap -p 80 -v --script http-shellshock --script-args uri=/cgi-bin/vulnscript.sh 192.168.200.5
nmap -p 80 -v --script http-shellshock --script-args uri=/cgi-bin/admin.cgi 192.168.200.5 
nmap -p 443 -v --script ssl-heartbleed 192.168.200.5 
nmap -sV -v --script=nfs-showmount 192.168.200.5
nmap -p 111 -v --script nfs* 192.168.200.5
nmap -p 111 -sV -v --script=rpcinfo 192.168.200.5
sudo nmap -p 139,445 -v --script=smb-vuln* 192.168.200.5 
sudo nmap -p 445 -v --script=smb-enum-shares,smb-enum-users 192.168.200.5 
sudo nmap -v --script=smb2-capabilities,smb-print-text,smb2-security-mode.nse,smb-protocols,smb2-time.nse,smb-psexec,smb2-vuln-uptime,smb-security-mode,smb-server-stats,smb-double-pulsar-backdoor,smb-system-info,smb-vuln-conficker,smb-enum-groups,smb-vuln-cve2009-3103,smb-enum-processes,smb-vuln-cve-2017-7494,smb-vuln-ms06-025,smb-enum-shares,smb-vuln-ms07-029,smb-enum-users,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-ls,smb-vuln-ms10-061,smb-vuln-ms17-010,smb-os-discovery --script-args=unsafe=1 -T5 192.168.200.5 -oG nmap-smb
sudo nmap -p 1433 -v --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV 192.168.200.5 -oG nmap-mssql 


# Default cred scan: 
changeme.py 192.168.200.5
changeme.py 192.168.200.5/24 
changeme.py nmap_subnet.xml 
changeme.py --protocols ssh,ssh_key 192.168.200.5/24 
changeme.py snmp://192.168.200.5

# Consider
mxweb mxcurls 
